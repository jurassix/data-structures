export { default as theme } from './themes/theme'
import { Invert, Split, SplitRight, FullScreenCode } from 'mdx-deck/layouts'
import { Image, Appear, Code } from 'mdx-deck'
import { Box } from 'grid-styled'

import { backgroundColor } from './constants'
import CodeLayout from './layouts/Code'

# CS Basics
### Data Structures
##### [Working with data]
---
# Clint Ayres
## @who_cayres
## https://github.com/jurassix
---
### The decisions we make in code
### function differently as data grows.
---
export default CodeLayout

```javascript

const group1 = ['Lucy', 'Amelia', 'Miller', 'Jody'];
const group2 = ['Gail', 'Sally', 'Marlyn', 'Jody'];

// includes 'Jody' twice
const all = [...group1, ...group2];

// how to remove duplicates???

```
---
### The Set data structure store's unique values of any type.
---
```javascript
const set = new Set();

set.add(1); // Set [ 1 ]
set.add(5); // Set [ 1, 5 ]
set.add(5); // Set [ 1, 5 ]

set.has(1); // true
set.has(3); // false

set.size; // 2

set.delete(5); // removes 5 from the set

// iterable
for (let item of set) console.log(item); // 1
```
---
export default CodeLayout

```javascript
const set = new Set();

// objects use referential equality (===)

set.add({ a: 1 }); // Set [ {a: 1} ]
set.add({ a: 1 }); // Set [ {a: 1}, {a: 1} ]

const b = { b: 2 };
set.add(b); // Set [ {a: 1}, {a: 1}, {b: 2} ]
set.add(b); // Set [ {a: 1}, {a: 1}, {b: 2} ]
```
---
### When you need to remove duplicates reach for Set.
---
export default CodeLayout

```javascript
// native set
const dedup = list => [...new Set(list)];

```
---
export default CodeLayout

```javascript
import uniq from 'lodash/uniq';

const dedup = list => uniq(list);

```
---
export default CodeLayout

```javascript

// forEach
const dedup = list => {
  const uniqueList = [];
  list.forEach(item => {
    if (!uniqueList.includes(item)) {
      uniqueList.push(item);
    }
  });
  return uniqueList;
};

```
---
https://jsperf.com/dedup/1
---
<Image src="./images/dedup_results.png" size="contain"/>
---
### why is our hand rolled solution so underperfomant?
---
### let's examine lodash for some advise

[uniq.js](https://raw.githubusercontent.com/lodash/lodash/master/uniq.js)

[baseUniq.js](https://raw.githubusercontent.com/lodash/lodash/master/.internal/baseUniq.js)

[setToArray.js](https://raw.githubusercontent.com/lodash/lodash/master/.internal/setToArray.js)
---
```javascript

// forEach
const SEEN = '__SEEN__';

const dedup = list => {
  const __cache = {};

  const uniqueList = [];
  list.forEach(item => {
    if (__cache[item] !== SEEN) {
      // update cache
      __cache[item] = SEEN;

      // add to list
      uniqueList.push(item);
    }
  });
  return uniqueList;
};
```
---
https://jsperf.com/dedup/10
---
<Image src="./images/dedup_refactor_results.png" size="contain"/>
---
### limitations: we can't support deduping lists with objects
---
export default CodeLayout

```jsx
const string = 'anything in quotes';
const number = 1980;
const date = new Date('11/07/1980')
const object = { 'key': 'value' };
const array = [ 1, 2, 3, 4 ];
```
---
export default CodeLayout

```javascript

const key = { 
  name: 'Lucy', 
  age: 4, 
  location: 'Atlanta'
};

const map = { 
  [key]: 'child' 
};

// { [object Object]: 'child' }
```
---
export default CodeLayout

```javascript

const map = {
  [{ a: 1 }]: 'child',
  [{ b: 1 }]: 'value',
};

// { [object Object]: 'value' }
```
---
### The Map data structure holds key-value pairs, and supports objects as keys.
---
```javascript
const map = new Map();

const string = 'key';
const object = {};
const fn = function() {};

// setting the values
map.set(string, 'string value');
map.set(object, 'object value');
map.set(fn, 'fn value');

map.has(fn) // true

// Map(3) {
//   "key" => "string value",
//   {} => "object value",
//   ƒ => "fn value"
// }
```
---
```javascript

// forEach
const dedup = list => {
  const __cache = new Map();

  const uniqueList = [];
  list.forEach(item => {
    if (!__cache.has(item)) {
      // update cache
      __cache.set(item, true);

      // add to list
      uniqueList.push(item);
    }
  });
  return uniqueList;
};
```
---
### The WeakSet data structure store's unique objcet refs, no iteration.
---

```javascript
const apis = new WeakSet();

apis
  .add({
    uri: '/api/users',
    method: 'GET',
  })
  .add({
    uri: '/api/roles',
    method: 'GET',
  });

```

```notes
demo - use performance tab to force a gc and clear the set
```
---
```javascript
const set = new WeakSet();
let go = true;

const work = () => {
  console.log('begin work');

  for (let i = 0; i < 100000; i++) {
    set.add({});
  }
  
  if (go) setTimeout(work, 0);
};

// kick it off!
work();
```

```notes 
if these were dom objects as we mutate the dom we are allowing those objects to be cleared
```
---
# The end